"use strict";var apiPrefix=location.protocol+"//"+location.hostname+":3000";angular.module("geekyTodoApp",["ngCookies","ngResource","ngSanitize","ngRoute"]).config(["$routeProvider",function(a){a.when("/register",{templateUrl:"views/register.html",controller:"RegisterCtrl"}).when("/login",{templateUrl:"views/signin.html",controller:"LoginCtrl"}).when("/items",{templateUrl:"views/viewtodo.html",controller:"ItemCtrl"}).when("/main",{templateUrl:"views/main.html",controller:"CategoryCtrl"}).when("/item",{templateUrl:"views/item.html",controller:"ItemCtrl"}).when("/welcome",{templateUrl:"views/registerresult.html",controller:"RegisterResultCtrl"}).otherwise({redirectTo:"/login"})}]),angular.module("geekyTodoApp").controller("RegisterCtrl",["$scope","signUpService","$location","$routeParams",function(a,b){a.newRegister=!0,a.registered=!1,a.registerStatus="SUCCESS",a.registerMessage="",a.error={username:"",password:"",confirmPassword:"",email:"",mobileNumber:""},a.newUser={username:"",password:"",email:"",firstName:"",lastName:"",mobileNumber:""},a.register=function(g){if(a.error.username="",a.error.password="",a.error.confirmPassword="",a.error.email="",a.error.mobileNumber="",void 0!==g)if(console.log(g),c(g.username)?a.newUser.username=g.username:f(a.error,"username","username is null or empty."),c(g.password)?"":f(a.error,"password","password is null or empty."),c(g.confirmPassword)?"":f(a.error,"confirmPassword","confirmPassword is null or empty."),c(g.password)?c(g.confirmPassword)?g.password!==g.confirmPassword?f(a.error,"password","password is not equal confirm password."):a.newUser.password=g.password:f(a.error,"confirmPassword","confirmPassword is null or empty."):f(a.error,"password","password is null or empty."),c(g.email)?d(g.email)?a.newUser.email=g.email:f(a.error,"email","Invalid format email."):f(a.error,"email","Email is null or empty."),c(g.mobileNumber)?e(g.mobileNumber)?a.newUser.mobileNumber=g.mobileNumber:f(a.error,"mobileNumber","Invalid format mobile number."):f(a.error,"mobileNumber","mobile number is null or empty."),a.newUser.firstName=g.firstName,a.newUser.lastName=g.lastName,""===a.error.username&&""===a.error.password&&""===a.error.confirmPassword&&""===a.error.email&&""===a.error.mobileNumber){var h=b.signup(a.newUser);h.then(function(b){console.log("RESULT = "+b.status+" : "+b.message),a.newRegister=!1,a.registered=!0,a.registerStatus=b.status,a.registerMessage=b.message},function(b){console.log("Error reason"+b),a.newRegister=!1,a.registered=!0,a.registerStatus=b.status,a.registerMessage=b.message})}else console.log("there are some input error!!!");else f(a.error,"user","user error."),console.log("null object")};var c=function(a){return console.log(a),void 0===a||""===a?!1:!0},d=function(a){var b=/\S+@\S+\.\S+/;return b.test(a)},e=function(a){return!isNaN(a)&&a.length>0&&a.length<=12},f=function(a,b,c){"username"===b?a.username=c:"password"===b?a.password=c:"confirmPassword"===b?a.confirmPassword=c:"email"===b?a.email=c:"mobileNumber"===b&&(a.mobileNumber=c)}}]),angular.module("geekyTodoApp").controller("RegisterResultCtrl",["$scope","$location",function(a,b){a.status=b.search().status,a.message=b.search().message}]),angular.module("geekyTodoApp").controller("LoginCtrl",["$scope","$rootScope","$http","LoginServices","$location",function(a,b,c,d,e){a.buttonDisable=!0,a.username="",a.password="",a.login=function(){d.login(a.username,a.password).then(f,g)},a.checkNull=function(){a.username&&a.password&&(a.buttonDisable=!1)};var f=function(a){"SUCCESS"==a.status?(b.token=a.token,e.path("/items")):alert(a.message)},g=function(a){console.log(a)}}]),angular.module("geekyTodoApp").controller("CategoryCtrl",["$scope","categoryService",function(a,b){a.register=function(){console.log("test")},a.categoryList=b.list(),a.newCat="",a.addCategory=function(){a.newCat&&(b.create({catName:a.newCat}),a.categoryList=b.list())},a.$watch("newCat",function(){a.isAddDisabled=a.newCat.trim()?!1:!0})}]),angular.module("geekyTodoApp").controller("ItemCtrl",["$scope","ItemServices","LoginServices","$location",function(a,b,c){c.requireLogin(),a.title="";var d=function(b){a.items=b.items},e=function(){b.getItemsList().then(d)},f=function(){a.title="",e()},g=function(){console.log("Failed")};a.addItem=function(){b.addItem(a.title).then(f,g)},e()}]);var geekyTodo=angular.module("geekyTodoApp");geekyTodo.factory("signUpService",["$http","$q",function(a,b){var c=function(c){var d=b.defer();return a.post("http://127.0.0.1:3000/api/users/signup",{data:c}).success(function(a){console.log("qwerty"+a.status+" ==== "+a.message),d.resolve(a)}).error(function(a){d.reject(a)}),d.promise};return{signup:c}}]),angular.module("geekyTodoApp").service("categoryService",["$http","$q",function(a,b){var c=function(){var c=b.defer();return a.get(apiPrefix+"/api/categories/").success(function(a){c.resolve(a)}).error(function(){c.reject()}),c.promise},d=function(c){var d=b.defer();return a.post(apiPrefix+"/api/category/",c).success(function(a){d.resolve(a)}).error(function(){d.reject()}),d.promise};return{create:d,list:c}}]),angular.module("geekyTodoApp").factory("ItemServices",["$http","$q",function(a,b){var c=apiPrefix+"/api/items/",d=apiPrefix+"/api/item/",e=function(){var d=b.defer();return a.get(c).success(function(a){d.resolve(a)}).error(function(a){d.reject(a)}),d.promise},f=function(c){var e=b.defer();return a.post(d,{title:c}).success(function(a){e.resolve(a)}).error(function(a){e.reject(a)}),e.promise};return{getItemsList:e,addItem:f}}]),angular.module("geekyTodoApp").factory("LoginServices",["$http","$q","$rootScope","$location",function(a,b,c,d){var e="http://54.254.28.194:3000/api/users/signin",f=function(a,b){var c={username:a,password:b};return g(e,c)},g=function(c,d){var e=b.defer();return a.post(c,d).success(function(a){e.resolve(a)}).error(function(a){e.reject(a)}),e.promise},h=function(){return"undefined"!=typeof c.token&&""!=c.token?!0:!1},i=function(){h()||d.path("/login")};return{login:f,isLogin:h,requireLogin:i}}]);